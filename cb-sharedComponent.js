!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common/http"),require("@angular/core"),require("@angular/router"),require("@angular/common")):"function"==typeof define&&define.amd?define("@shared/src/lib/shared-components",["exports","@angular/common/http","@angular/core","@angular/router","@angular/common"],t):t((e=e||self).sharedComponents={},e.ng.common.http,e.ng.core,e.ng.router,e.ng.common)}(this,(function(e,t,r,n,i){"use strict";function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e,t){return e(t={exports:{}},t.exports),t.exports}t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r,n=n&&n.hasOwnProperty("default")?n.default:n,i=i&&i.hasOwnProperty("default")?i.default:i,"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var s=o((function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var a=r,o=n,s=t,d=function(){function e(e,t){this.activeRoute=e,this.httpclient=t}return e.prototype.findInputValues=function(e,t){for(var r={},n=0;n<e.length;n++){var i=e[n];r[i.paramName]=this.getParameterValue(i,t)}return r},e.prototype.getParameterValue=function(e,t){switch(e.sourceType){case 1:return e.paramValue;case 2:var r;return this.activeRoute.paramMap.subscribe((function(e){e.has("params")&&(r=e)})),r;case 3:return JSON.parse(localStorage.getItem(e.paramValue))||null;case 4:return JSON.parse(sessionStorage.getItem(e.paramValue))||null;case 5:break;case 6:return e;case 7:return t[e.paramValue.toLowerCase()]&&t[e.paramValue.toLowerCase()].value?t[e.paramValue.toLowerCase()].value:"";default:return}},e.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:n.ActivatedRoute},{type:t.HttpClient}]},e.ngInjectableDef=a.ɵɵdefineInjectable({factory:function(){return new e(a.ɵɵinject(o.ActivatedRoute),a.ɵɵinject(s.HttpClient))},token:e,providedIn:"root"}),e}();i.DataSourceService=d})),d=(a(s),s.DataSourceService,o((function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var a=r,o=t,s=i,d=function(){function e(e,t){this.http=e,this.datePipe=t}return e.prototype.getRequests=function(e,t){return this.http.get(e,t)},e.prototype.postRequests=function(e,t,r){return void 0===t&&(t={}),void 0===r&&(r={}),this.http.post(e,t,r)},e.prototype.putRequests=function(e,t,r){return void 0===t&&(t={}),void 0===r&&(r={}),this.http.put(e,t,r)},e.prototype.paymentStatus=function(e,t,r,n,i){return this.getRequests("/Quickpay/update/1/"+r+"/"+e+"/"+n+"/"+t,i)},e.prototype.getOrder=function(e,t){return this.http.get("/orders/"+e,t)},e.prototype.formatNumberToMoney=function(e,t){if(e)return t+"  "+e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")},e.prototype.getItems=function(e,t){var r=this,n="",i="",a='<tr style="background:#eeeeee;text-align: center; height: 30px;">\n    <th>Product</th>\n    <th>Price</th>\n    <th>Quantity</th>';return e.taxAmount>0&&("SE"===e.shippingAddress.countryId||"SE"!==e.shippingAddress.countryId&&1===e.registrationType)&&(a+="<th>Moms/VAT %</th>"),a+="<th>Total</th>\n  </tr>",e.orderItems.forEach((function(t){n=n||"\n      <li>\n      "+(t.productDate?r.datePipe.transform(new Date(t.productDate).toLocaleDateString(),"longDate"):"")+"  "+t.productName+"\n      </li>\n      ",i+="<tr>\n        <td>"+t.productId+' </td>\n        <td style="text-align: left"> '+(t.productDate?r.datePipe.transform(new Date(t.productDate).toLocaleDateString(),"longDate"):"")+"  "+t.productName+' </td>\n        <td style="text-align: left"> '+e.orderTotalString+' </td>\n        <td style="text-align: right"> '+t.quantity+" </td>\n      </tr>",a+='<tr>\n      <td style="color: #333; border: #eeeeee  solid 1px;    text-align: center;">\n      '+(t.productDate?r.datePipe.transform(new Date(t.productDate).toLocaleDateString(),"longDate"):"")+"  "+t.productName,t&&t.variationOptions&&t.variationOptions.length>0&&(a+='<ul class="list-group" style="text-align:left; margin-left:40px;">',t.variationOptions.forEach((function(e){a+='<li class="list-group-item"> <span>'+(e.optionName?e.optionName.charAt(0).toUpperCase()+e.optionName.slice(1):e.optionName)+":</span> "+e.value+" </li>"})),a+="</ul>"),a+='</td>\n      <td style="color: #333; border: #eeeeee  solid 1px;    text-align: right;">\n        '+t.productPriceString+' </td>\n      <td style="color: #333; border: #eeeeee  solid 1px;    text-align: center;">\n        '+t.quantity+"</td>",t.taxPercent>0&&("SE"===e.shippingAddress.countryId||"SE"!==e.shippingAddress.countryId&&1===e.registrationType)&&(a+='<td style="color: #333; border: #eeeeee  solid 1px;    text-align: center;">\n          '+(t.taxPercent?100*+t.taxPercent:0)+" %</td>"),a+='<td style="color: #333; border: #eeeeee  solid 1px;    text-align: right;">\n        '+t.totalString+"</td>\n\n    </tr>"})),0!=t.length&&t.forEach((function(e){e.feesValue&&0!=e.feesValue&&(a+='<tr style="text-align: right;">\n                          <td colspan="4"><b>'+e.feesName+'</b></td>\n                          <td style="text-align: right;">'+e.feesValueString+"</td>\n                          </tr>")})),e.discountAmount&&0!=e.discountAmount&&(a+='<tr style="text-align: right;">\n                      <td colspan="4"><b>Discount</b></td>\n                      <td style="text-align: right;">'+e.discountAmountString+"</td>\n                      </tr>"),e.subTotalWithDiscount&&0!==e.subTotalWithDiscount&&e.subtotal!=e.subTotalWithDiscount&&(a+=' <tr style="text-align: right;">\n              <td colspan="4"><b>Subtotal with discount</b></td>\n              <td style="text-align: right;">'+e.subtotalWithDiscountString+"</td>\n            </tr>"),e.taxAmount>0&&("SE"===e.shippingAddress.countryId||"SE"!==e.shippingAddress.countryId&&1===e.registrationType)&&(a+='\n                    <tr style="text-align: right;">\n                    <td colspan="4"><b>Moms/VAT</b></td>\n                    <td style="text-align: right;">'+e.taxAmountString+"</td>\n                    </tr>"),{items:a,courses:n,adminItems:i}},e.prototype.sendEmail=function(e,r,n,i,a,o,s){var d=this.getItems(e,o),u=d.items;a===l.Admin&&(u=d.adminItems);var c={NotificationType:3,SendVia:2,SendValue:i,Severity:1,emailSenderVM:{Emails:i,TemplateId:r,isHtml:!0,attachment:null,Params:[{Param:"[Name]",Value:s||e.customerName},{Param:"[Date]",Value:this.datePipe.transform((new Date).toLocaleDateString(),"dd/MM/yyyy")},{Param:"[InvoiceNo]",Value:e.id},{Param:"[OrderTotal]",Value:e.orderTotalString},{Param:"<tr><td>[Items]</td></tr>",Value:u},{Param:"[CompanyOrName]",Value:1===e.registrationType?e.nameOnReceipt:e.company},{Param:"[FullAddress]",Value:this.getAddress(e)},{Param:"[purchaserName]",Value:e.customerName},{Param:"[courseName]",Value:d.courses},{Param:"[Email]",Value:e.customerEmail},{Param:"[Phone]",Value:e.customerName?e.customerName:""}]}};return this.http.post("/Notification/send",c,{headers:new t.HttpHeaders({siteId:n+""})}).pipe()},e.prototype.getCountryName=function(e,t){var r=t.find((function(t){return t.value==e}));return r?r.text:""},e.prototype.getAddress=function(e){var t="";return t+=""+(e.useBillingAsShippingAddress?e.shippingAddress.addressLine1:e.billingAddress.addressLine1?e.billingAddress.addressLine1:""),e.shippingAddress.addressLine2Only&&e.useBillingAsShippingAddress?t+="<br> "+e.shippingAddress.addressLine2Only:e.billingAddress.addressLine2Only&&!e.useBillingAsShippingAddress&&(t+="<br> "+e.billingAddress.addressLine2Only),(e.shippingAddress.zipCode||e.shippingAddress.cityName)&&e.useBillingAsShippingAddress&&(t+="<br> "+(e.shippingAddress.zipCode?e.shippingAddress.zipCode:"")+" "+(e.shippingAddress.cityName?e.shippingAddress.cityName:"")+"<br>"),!e.billingAddress.zipCode&&!e.billingAddress.cityName||e.useBillingAsShippingAddress||(t+="<br> "+(e.billingAddress.zipCode?e.billingAddress.zipCode:"")+" "+(e.billingAddress.cityName?e.billingAddress.cityName:"")+"<br>"),e.shippingAddress.stateOrProvinceName&&e.useBillingAsShippingAddress&&(t+=e.shippingAddress.stateOrProvinceName+", "),e.billingAddress.stateOrProvinceName&&!e.useBillingAsShippingAddress&&(t+=e.billingAddress.stateOrProvinceName+", "),t+""+(e.useBillingAsShippingAddress?e.shippingAddress.countryName?e.shippingAddress.countryName:"":e.billingAddress.countryName?e.billingAddress.countryName:"")},e.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:t.HttpClient},{type:i.DatePipe}]},e.ngInjectableDef=a.ɵɵdefineInjectable({factory:function(){return new e(a.ɵɵinject(o.HttpClient),a.ɵɵinject(s.DatePipe))},token:e,providedIn:"root"}),e}();n.EcommerceSharedService=d,n.Order=function(){},n.Address=function(){},n.OrderItem=function(){},n.VariationOptions=function(){},n.Country=function(){},n.Fees=function(){};var l={customer:1,Admin:2,OrderMaker:3};n.EmailRecieverType=l,l[l.customer]="customer",l[l.Admin]="Admin",l[l.OrderMaker]="OrderMaker"}))),l=(a(d),d.EcommerceSharedService,d.Order,d.Address,d.OrderItem,d.VariationOptions,d.Country,d.Fees,d.EmailRecieverType,o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DataSourceService=s.DataSourceService,t.EcommerceSharedService=d.EcommerceSharedService,t.EmailRecieverType=d.EmailRecieverType}))),u=(a(l),l.DataSourceService,l.EcommerceSharedService,l.EmailRecieverType,o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DataSourceService=l.DataSourceService,t.EcommerceSharedService=l.EcommerceSharedService,t.EmailRecieverType=l.EmailRecieverType}))),c=a(u),p=u.DataSourceService,m=u.EcommerceSharedService,g=u.EmailRecieverType;e.DataSourceService=p,e.EcommerceSharedService=m,e.EmailRecieverType=g,e.default=c,Object.defineProperty(e,"__esModule",{value:!0})}));